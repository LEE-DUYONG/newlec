<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newlec.dao.NoticeBoardDao">

	<!-- 게시물 리스트 조회 -->
	<select id="getBoardList" resultType="com.newlec.domain.NoticeBoardVO">
		SELECT NUM, TITLE, CREATED_DATE　"createdDate", HIT, a.id ||'('|| a.username ||')' "memberId"
		FROM TBL_MEMBER a , TBL_NOTICE_BOARD b
		where a.id = b.MEMBER_ID order by b.num desc
	</select>
	
	<!-- 게시물 세부 조회 -->
	<select id="getBoardDetail" resultType="com.newlec.domain.NoticeBoardVO">
		SELECT NUM, TITLE, CONTENT, CREATED_DATE　"createdDate", HIT, a.id ||'('|| a.username ||')' "memberId"
		FROM TBL_MEMBER a , TBL_NOTICE_BOARD b
		WHERE a.id = b.MEMBER_ID and NUM = #{num}
	</select>
	
	<!--새글 작성 후 게시물 번호 조회 -->
	<select id="getNewBoardNum" resultType="int">
		SELECT NUM
		FROM TBL_NOTICE_BOARD
		WHERE member_id = #{memberId} and rownum = 1
        order by num desc
	</select>
	
	<!-- 게시물 등록 -->
	<insert id="insertBoard" parameterType="com.newlec.domain.NoticeBoardVO">
		INSERT INTO TBL_NOTICE_BOARD(
			NUM, TITLE, CREATED_DATE, HIT, MEMBER_ID, CONTENT
		) values(
			seq_notice_board.nextval, #{title}, SYSDATE , 0, #{memberId}, #{content}
		)
	</insert>
	
	<!-- 게시물 수정 -->
	<update id="updateBoard" parameterType="com.newlec.domain.NoticeBoardVO">
		UPDATE TBL_NOTICE_BOARD
		set TITLE = #{title}, CONTENT = #{content}
		where NUM = #{num}
	</update>
	
	<!-- 게시물 삭제 -->
	<delete id="deleteBoard" parameterType="int">
		delete from TBL_NOTICE_BOARD
		where NUM = #{num}
	</delete>
	
	<!-- 조회수 + 1 -->
	<update id="upCountHits" parameterType="int">
		UPDATE TBL_NOTICE_BOARD
		set hit = hit + 1
		where NUM = #{num}
	</update>
	
</mapper>